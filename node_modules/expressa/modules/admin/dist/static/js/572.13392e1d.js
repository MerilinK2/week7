"use strict";(self.webpackChunkexpressa_admin=self.webpackChunkexpressa_admin||[]).push([[572],{3634:function(t,e,n){n.d(e,{A:function(){return m}});var i=n(5410),s=n(2901),a=n(388),r=n(1573),o=n(991),u=n(5361);function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function l(t,e,n,i){var s=(0,o.A)((0,r.A)(1&i?t.prototype:t),e,n);return 2&i&&"function"==typeof s?function(t){return s.apply(n,t)}:s}n(9872);var h=n(3692).JSONEditor,d={props:{value:{type:Object,default:function(){}},schema:{type:Object,default:function(){}}},data:function(){return{editor:null,error:!1,json:this.value,internalChange:!1}},watch:{},mounted:function(){this.update()},methods:{update:function(){var t=this,e={schema:this.schema,startval:this.value,theme:"bootstrap4",iconlib:"materialicons",required_by_default:!0};this.editor&&this.editor.destroy(),this.editor=new h(this.$el.querySelector(".jsoneditor-vue"),e);var n,i=!0;this.editor.on("change",(function(){i?i=!1:t.$emit("input",t.editor.getValue())})),(n=document.querySelector(".je-modal .je-edit-json--textarea")).classList.remove("je-edit-json--textarea"),n.classList.add("expandable-textarea")},onSave:function(){this.$emit("json-save",this.json)}}};h&&(h.defaults.resolvers.unshift((function(t){if("object"===t.type&&"schema"===t.format)return"schema"})),h.defaults.editors.schema=function(t){function e(){return(0,i.A)(this,e),t=this,n=e,s=arguments,n=(0,r.A)(n),(0,a.A)(t,c()?Reflect.construct(n,s||[],(0,r.A)(t).constructor):n.apply(t,s));var t,n,s}return(0,u.A)(e,t),(0,s.A)(e,[{key:"setValue",value:function(t,e){this.value=t,this.schemaeditor.setValue(t),this.onChange()}},{key:"getValue",value:function(){return void 0!==this.schemaeditor?this.schemaeditor.getValue():{}}},{key:"register",value:function(){l(e,"register",this,3)([]),this.input&&this.input.setAttribute("name",this.formname)}},{key:"unregister",value:function(){l(e,"unregister",this,3)([]),this.input&&this.input.removeAttribute("name")}},{key:"getNumColumns",value:function(){return 12}},{key:"build",value:function(){var t=this;this.options.compact||(this.label=this.header=this.theme.getFormInputLabel(this.getTitle())),this.schema.description&&(this.description=this.theme.getFormInputDescription(this.schema.description)),this.options.compact&&(this.container.className+=" compact"),this.input=document.createElement("div"),this.control=this.theme.getFormControl(this.label,this.input,this.description),(this.schema.readOnly||this.schema.readonly)&&(this.always_disabled=!0,this.input.disabled=!0),this.container.appendChild(this.control),this.schemaeditor=new window.JSONSchemaEditor(this.input,{startval:{}}),this.schemaeditor.on("change",(function(){t.onChange(!0)}))}},{key:"enable",value:function(){this.always_disabled||(this.input.disabled=!1),l(e,"enable",this,3)([])}},{key:"disable",value:function(){this.input.disabled=!0,l(e,"disable",this,3)([])}},{key:"destroy",value:function(){this.label&&this.label.parentNode&&this.label.parentNode.removeChild(this.label),this.description&&this.description.parentNode&&this.description.parentNode.removeChild(this.description),this.input&&this.input.parentNode&&this.input.parentNode.removeChild(this.input),l(e,"destroy",this,3)([])}}])}(h.AbstractEditor));var p=d,m=(0,n(4486).A)(p,(function(){var t=this;t.$createElement;return t._self._c,t._m(0)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("div",{staticClass:"jsoneditor-vue"})])}],!1,null,null,null).exports},1572:function(t,e,n){n.r(e),n.d(e,{default:function(){return l}});var i,s=n(467),a=n(4756),r=n.n(a),o=n(9906),u={name:"Install",components:{JSONEditor:n(3634).A},data:function(){return{data:{},ready:!1}},watch:{"$route.path":{handler:"update"}},mounted:(i=(0,s.A)(r().mark((function t(){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.update();case 1:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)}),methods:{update:function(){var t=this;return(0,s.A)(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,o.A)({url:"/install/settings/schema"});case 2:t.schema=e.sent.data.schema,t.ready=!0;case 4:case"end":return e.stop()}}),e)})))()},install:function(){var t=this;return(0,s.A)(r().mark((function e(){var n,i;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,o.A)({method:"post",url:"/install",data:{settings:t.data,modules:["collections","core","logging","permissions"]}});case 2:return n=t.data.email,i=t.data.password,e.next=6,(0,o.A)({method:"post",url:"/users/register",data:{email:n,roles:["Admin"],password:i}});case 6:t.$store.dispatch("Login",{username:n,password:i}).then((function(){t.loading=!1,t.$router.push({path:t.redirect||"/"})})).catch((function(){t.loading=!1}));case 7:case"end":return e.stop()}}),e)})))()}}},c=u,l=(0,n(4486).A)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"container"},[n("div",{staticClass:"error-message"},[t._v("\n      "+t._s(t.error)+"\n    ")]),t.ready?[t.ready?n("JSONEditor",{attrs:{schema:t.schema},model:{value:t.data,callback:function(e){t.data=e},expression:"data"}}):t._e(),n("div",[n("button",{staticClass:"btn btn-primary",on:{click:t.install}},[t._v("\n          Install\n        ")])])]:t._e()],2)])}),[],!1,null,"300598f4",null).exports}}]);