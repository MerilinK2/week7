"use strict";(self.webpackChunkexpressa_admin=self.webpackChunkexpressa_admin||[]).push([[269],{3634:function(t,e,n){n.d(e,{A:function(){return m}});var a=n(5410),i=n(2901),r=n(388),s=n(1573),o=n(991),c=n(5361);function u(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(u=function(){return!!t})()}function l(t,e,n,a){var i=(0,o.A)((0,s.A)(1&a?t.prototype:t),e,n);return 2&a&&"function"==typeof i?function(t){return i.apply(n,t)}:i}n(9872);var d=n(3692).JSONEditor,h={props:{value:{type:Object,default:function(){}},schema:{type:Object,default:function(){}}},data:function(){return{editor:null,error:!1,json:this.value,internalChange:!1}},watch:{},mounted:function(){this.update()},methods:{update:function(){var t=this,e={schema:this.schema,startval:this.value,theme:"bootstrap4",iconlib:"materialicons",required_by_default:!0};this.editor&&this.editor.destroy(),this.editor=new d(this.$el.querySelector(".jsoneditor-vue"),e);var n,a=!0;this.editor.on("change",(function(){a?a=!1:t.$emit("input",t.editor.getValue())})),(n=document.querySelector(".je-modal .je-edit-json--textarea")).classList.remove("je-edit-json--textarea"),n.classList.add("expandable-textarea")},onSave:function(){this.$emit("json-save",this.json)}}};d&&(d.defaults.resolvers.unshift((function(t){if("object"===t.type&&"schema"===t.format)return"schema"})),d.defaults.editors.schema=function(t){function e(){return(0,a.A)(this,e),t=this,n=e,i=arguments,n=(0,s.A)(n),(0,r.A)(t,u()?Reflect.construct(n,i||[],(0,s.A)(t).constructor):n.apply(t,i));var t,n,i}return(0,c.A)(e,t),(0,i.A)(e,[{key:"setValue",value:function(t,e){this.value=t,this.schemaeditor.setValue(t),this.onChange()}},{key:"getValue",value:function(){return void 0!==this.schemaeditor?this.schemaeditor.getValue():{}}},{key:"register",value:function(){l(e,"register",this,3)([]),this.input&&this.input.setAttribute("name",this.formname)}},{key:"unregister",value:function(){l(e,"unregister",this,3)([]),this.input&&this.input.removeAttribute("name")}},{key:"getNumColumns",value:function(){return 12}},{key:"build",value:function(){var t=this;this.options.compact||(this.label=this.header=this.theme.getFormInputLabel(this.getTitle())),this.schema.description&&(this.description=this.theme.getFormInputDescription(this.schema.description)),this.options.compact&&(this.container.className+=" compact"),this.input=document.createElement("div"),this.control=this.theme.getFormControl(this.label,this.input,this.description),(this.schema.readOnly||this.schema.readonly)&&(this.always_disabled=!0,this.input.disabled=!0),this.container.appendChild(this.control),this.schemaeditor=new window.JSONSchemaEditor(this.input,{startval:{}}),this.schemaeditor.on("change",(function(){t.onChange(!0)}))}},{key:"enable",value:function(){this.always_disabled||(this.input.disabled=!1),l(e,"enable",this,3)([])}},{key:"disable",value:function(){this.input.disabled=!0,l(e,"disable",this,3)([])}},{key:"destroy",value:function(){this.label&&this.label.parentNode&&this.label.parentNode.removeChild(this.label),this.description&&this.description.parentNode&&this.description.parentNode.removeChild(this.description),this.input&&this.input.parentNode&&this.input.parentNode.removeChild(this.input),l(e,"destroy",this,3)([])}}])}(d.AbstractEditor));var p=h,m=(0,n(4486).A)(p,(function(){var t=this;t.$createElement;return t._self._c,t._m(0)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("div",{staticClass:"jsoneditor-vue"})])}],!1,null,null,null).exports},2269:function(t,e,n){n.r(e),n.d(e,{default:function(){return h}});var a,i=n(467),r=n(4756),s=n.n(r),o=n(9906),c=n(3634),u=n(7514),l={name:"CollectionTable",components:{JSONEditor:c.A},props:{collectionName:{type:String,default:""},id:{type:String,default:""}},data:function(){return{data:{},collectionName:"",id:"",error:"",options:{mode:"text"},schema:{},ready:!1}},watch:{"$route.path":{handler:"update"}},mounted:(a=(0,i.A)(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.update();case 1:case"end":return t.stop()}}),t,this)}))),function(){return a.apply(this,arguments)}),methods:{update:function(){var t=this;return(0,i.A)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.ready=!1,t.$route.params.collectionName&&(t.collectionName=t.$route.params.collectionName),t.$route.params.id&&(t.id=t.$route.params.id),e.prev=3,"create"===t.id){e.next=10;break}return e.next=7,(0,o.A)({url:"/".concat(t.collectionName,"/").concat(t.id)});case 7:t.data=e.sent.data,e.next=11;break;case 10:t.data={};case 11:return e.next=13,(0,o.A)({url:"/".concat(t.collectionName,"/schema")});case 13:t.schema=e.sent.data,t.ready=!0,e.next=20;break;case 17:e.prev=17,e.t0=e.catch(3),t.error=e.t0.error||e.t0;case 20:case"end":return e.stop()}}),e,null,[[3,17]])})))()},save:function(){var t=this;return(0,i.A)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("create"!==t.id){e.next=5;break}return e.next=3,(0,o.A)({method:"post",url:"/".concat(t.collectionName),data:t.data});case 3:e.next=7;break;case 5:return e.next=7,(0,o.A)({method:"put",url:"/".concat(t.collectionName,"/").concat(t.id),data:t.data});case 7:if("collection"!==t.collectionName){e.next=12;break}return e.next=10,(0,o.A)({url:"/status/"});case 10:t.statusInfo=e.sent.data,u.A.dispatch("StatusInfo",t.statusInfo);case 12:"users"===t.collectionName?t.$router.push("/users/list"):"settings"===t.collectionName?t.$router.push("/home"):t.$router.push("/list/".concat(t.collectionName,"/"));case 13:case"end":return e.stop()}}),e)})))()},del:function(){var t=this;return(0,i.A)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,o.A)({method:"delete",url:"/".concat(t.collectionName,"/").concat(t.id)});case 2:t.$router.push("/list/".concat(t.collectionName,"/"));case 3:case"end":return e.stop()}}),e)})))()}}},d=l,h=(0,n(4486).A)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"container"},[n("div",{staticClass:"error-message"},[t._v("\n      "+t._s(t.error)+"\n    ")]),t.ready?[t.ready?n("JSONEditor",{attrs:{schema:t.schema},model:{value:t.data,callback:function(e){t.data=e},expression:"data"}}):t._e(),n("div",[n("button",{staticClass:"btn btn-primary",on:{click:t.save}},[t._v("\n          Save\n        ")]),n("button",{staticClass:"btn btn-danger",on:{click:t.del}},[t._v("\n          Delete\n        ")])])]:t._e()],2)])}),[],!1,null,null,null).exports}}]);