"use strict";(self.webpackChunkexpressa_admin=self.webpackChunkexpressa_admin||[]).push([[651],{7651:function(e,n,r){r.r(n),r.d(n,{default:function(){return l}});var t=r(467),a=r(4756),o=r.n(a),i=r(9906);function s(e,n){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,n){if(e){if("string"==typeof e)return u(e,n);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var t=0,a=function(){};return{s:a,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw o}}}}function u(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=Array(n);r<n;r++)t[r]=e[r];return t}var c={name:"ManagePermissions",data:function(){return{roles:[],data:[]}},mounted:function(){this.update()},methods:{update:function(){var e=this;return(0,t.A)(o().mark((function n(){var r,t,a,s,u;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,i.A)({url:"/role/"});case 2:e.roles=n.sent.data,r=e.roles.find((function(e){return"Admin"===e._id})),t=Object.keys(r.permissions),a=["Admin","Authenticated","Anonymous"],e.roles.sort((function(e,n){var r=a.indexOf(e._id),t=a.indexOf(n._id);return r!==t?r-t:e._id.localeCompare(n._id)})),s=function(e,n){return e[n._id]=n.permissions[e.name],e},u=t.map((function(n){return e.roles.reduce(s,{name:n})})),e.data=u.sort((function(e,n){return e.name<n.name?-1:1}));case 10:case"end":return n.stop()}}),n)})))()},save:function(){var e=this;return(0,t.A)(o().mark((function n(){var r,t,a;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=s(e.roles),n.prev=1,a=o().mark((function n(){var r;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(r=t.value).permissions={},e.data.forEach((function(e){e[r._id]&&(r.permissions[e.name]=1)})),n.next=5,(0,i.A)({method:"put",url:"/role/".concat(r._id),data:r});case 5:case"end":return n.stop()}}),n)})),r.s();case 4:if((t=r.n()).done){n.next=8;break}return n.delegateYield(a(),"t0",6);case 6:n.next=4;break;case 8:n.next=13;break;case 10:n.prev=10,n.t1=n.catch(1),r.e(n.t1);case 13:return n.prev=13,r.f(),n.finish(13);case 16:case"end":return n.stop()}}),n,null,[[1,10,13,16]])})))()}}},l=(0,r(4486).A)(c,(function(){var e=this,n=e.$createElement,r=e._self._c||n;return r("div",{staticClass:"app-container"},[r("el-table",{attrs:{data:e.data,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""}},[r("el-table-column",{attrs:{align:"left",label:"Permission Name",width:"250"},scopedSlots:e._u([{key:"default",fn:function(n){return[e._v("\n        "+e._s(n.row.name)+"\n      ")]}}])}),e._l(e.roles,(function(n){return r("el-table-column",{key:n._id,attrs:{label:n._id,align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("input",{directives:[{name:"model",rawName:"v-model",value:t.row[n._id],expression:"scope.row[role._id]"}],attrs:{name:t.row.role,disabled:"Admin"==n._id,type:"checkbox"},domProps:{checked:Array.isArray(t.row[n._id])?e._i(t.row[n._id],null)>-1:t.row[n._id]},on:{change:[function(r){var a=t.row[n._id],o=r.target,i=!!o.checked;if(Array.isArray(a)){var s=e._i(a,null);o.checked?s<0&&e.$set(t.row,n._id,a.concat([null])):s>-1&&e.$set(t.row,n._id,a.slice(0,s).concat(a.slice(s+1)))}else e.$set(t.row,n._id,i)},e.save]}})]}}])})}))],2)],1)}),[],!1,null,"27261770",null).exports}}]);